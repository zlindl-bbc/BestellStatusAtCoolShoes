package ch.it.bzz.coolshoes.dbconnection;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import ch.it.bzz.coolshoes.exception.CoolShoesException;
import ch.it.bzz.coolshoes.util.SqlUtil;

/**
 * @author Luca Lindegger
 * @date 2017-06-27
 * @version 1.0
 */

public class UserData {

  public static boolean doesExist(String forename) {
    String forename1 = "'" + forename + "';";
    String sql = "SELECT * from Mitarbeiter WHERE Vorname =" + forename1;
    Connection con = null;
    PreparedStatement ps = null;
    ResultSet rs = null;

    try {
      con = SqlUtil.getConnection();
      ps = con.prepareStatement(sql);
      rs = ps.executeQuery();

      if (rs.first() == true) {
        return true;
      } else {
        return false;
      }
    } catch (SQLException e) {
      throw new CoolShoesException("Es hat einen Fehler bei einer Datenbankabfrage gegeben.",
          e.toString());
    }
    finally {
      SqlUtil.DoCloseAll(con, ps, rs);
    }
  }

  public static String getPassword(String forename) {
    String forename1 = "'" + forename + "'";
    String sql = "SELECT Passwort from Mitarbeiter WHERE Vorname =" + forename1;
    Connection con = null;
    PreparedStatement ps = null;
    ResultSet rs = null;
    
    try {
      con = SqlUtil.getConnection();
      ps = con.prepareStatement(sql);
      rs = ps.executeQuery();
      
      rs.first();
      String dbPassword = rs.getString("Passwort");
      return dbPassword;
    }
    catch (SQLException e) {
      throw new CoolShoesException("Es hat einen Fehler bei einer Datenbankabfrage gegeben.",
          e.toString());
    }
    finally {
      SqlUtil.DoCloseAll(con, ps, rs);
    }
  }
  
  public static void test() {
    Connection con = null;
    String sql = "INSERT INTO Kunde (Name, Vorname, PLZ) VALUES ('Testname', 'Testforename', 6030);";
    
    try {
      con = SqlUtil.getConnection();
      PreparedStatement ps = con.prepareStatement(sql);
      stmt.execute();
      stmt.close();
    }
    catch (SQLException e) {
      throw new CoolShoesException("Es hat einen Fehler bei einer Datenbankabfrage gegeben.",
          e.toString());
    }
  }
  public static void main(String[] args){
    test();
  }

}
