package ch.it.bzz.coolshoes.exception;

import java.io.File;
import java.io.FileWriter;
import java.io.ObjectInputStream.GetField;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JOptionPane;

import ch.it.bzz.coolshoes.util.WindowsUtil;

/**
 * @author Luca Lindegger
 * @version 1.0
 * @since 2017-06-28
 */


public class CoolShoesException extends RuntimeException {

  private static final long serialVersionUID = 9182225131558976139L;
  private static String errorMessage;

  public CoolShoesException(String errorMsg, String e) {
    setErrorMessage(errorMsg);
    CoolShoesException.logError(errorMsg.toString());

  }

  public static void logError(String e) {
    try {
      String path = WindowsUtil.getCurrentUserDesktopPath() + "\\" + "ErrorLog.txt";
      File file = new File(path);
      DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
      Date date = new Date();
      FileWriter fileWriter = new FileWriter(file, true);
      fileWriter.write(dateFormat.format(date));
      fileWriter.write("     ");
      fileWriter.write(getErrorMessage());
      fileWriter.write("\r\n");
      fileWriter.write(e);
      fileWriter.write("\r\n");
      fileWriter.write("\r\n");
      fileWriter.flush();
      fileWriter.close();
    } catch (Exception e2) {
      System.err.println("File cannot be found.");
    }
    
  }
  
  public static void showMessage(boolean successToLog){
    
    JOptionPane.showMessageDialog(null, "Something went wrong with the Database. \nYour Error has been logged to 'Desktop/ErrorLog.txt'.", "Error", JOptionPane.ERROR_MESSAGE);
  }

  public void setErrorMessage(String errorMessage) {
    this.errorMessage = errorMessage;
  }

  public static String getErrorMessage() {
    return errorMessage;
  }
  
  public static void main(String[] args){
    errorMessage = "SQL";
    System.out.println();
    logError("Das ist ein Test... dsklfjdskhflsjadgkfjasghdkjfadskjfgadskjg");
  }



}
