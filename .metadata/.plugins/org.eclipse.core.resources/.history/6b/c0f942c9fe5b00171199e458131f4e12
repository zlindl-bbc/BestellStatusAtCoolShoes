package ch.it.bzz.coolshoes.dbconnection;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

/**
 * @author Luca Lindegger
 * @date 2017-06-27
 * @version 1.0
 */

public class SqlUtil {
  private static Connection connection;

  public static Connection getConnection() {
    String path = "../../../../../../Database/CoolShoes.accdb";

    try {
      // Connect database with connector
      Class.forName("net.ucanaccess.jdbc.UcanaccessDriver");
      connection = DriverManager.getConnection("jdbc:ucanaccess://" + path);
    } catch (ClassNotFoundException error) {
      // the driver class is currently not available
      System.out.println("Treiber kann nicht gelesen werden");
    } catch (SQLException error) {
      // the database cannot be contacted
      // caused of a wrong name, wrong path, wrong driver,...
      System.out.println("Verbindung kann nicht aufgebaut werden");
    }
    return connection;
  }

  public void setConnection(Connection connection) {
    this.connection = connection;
  }

  public void closeConnection() {
    try {
      if (connection != null) {
        connection.close();
      }
    } catch (SQLException e) {
      System.out.println("Error by closing the connection.");
    }
  }
}
